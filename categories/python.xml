<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>琅環笔记 (关于 python 的文章)</title><link>https://note.tt4e.com/</link><description></description><atom:link href="https://note.tt4e.com/categories/python.xml" rel="self" type="application/rss+xml"></atom:link><language>zh_cn</language><copyright>Contents © 2024 &lt;a href="mailto:xiaoyao@tt4e.com"&gt;逍遥&lt;/a&gt; </copyright><lastBuildDate>Mon, 08 Apr 2024 20:03:08 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>The different linesep between codecs open and open in python 3</title><link>https://note.tt4e.com/posts/the-different-linesep-between-codecs-open-and-open-in-python-3/</link><dc:creator>逍遥</dc:creator><description>&lt;section id="section-1"&gt;
&lt;h2&gt;文件分隔符之回车换行的故事&lt;/h2&gt;
&lt;p&gt;最初的打字机上，将打字位置 Carriage 从行末移动到行首叫做 Carriage Return，既CR，既回车，将纸张上滚一行，叫做换行 Linefeed。&lt;/p&gt;
&lt;p&gt;来到计算机时代，分别为这两种操作都定义了 ASCII 码&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;ASCII \n: CR，Carriage Return，UNIX 上是行分隔符，newline，取第一个字；macOS 也采用了此换行符；&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ASCII \r: LF，Linefeed，Classic Mac OS 中，文件换行符是这个；&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ASCII \r\n: CRLF，Carriage Return &amp;amp; Linefeed，Windows 最晚出现，为在 Windows 上能显示 Unix 和 Apple Mac OS 文件内容，弄出一个兼容的。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
&lt;section id="python"&gt;
&lt;h2&gt;Python 世界的换行&lt;/h2&gt;
&lt;p&gt;为兼容各平台差异，Python 的 os 模块中弄出多个属性来处理，比如&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;linesep 行分隔符&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;sep 文件路径名分割符&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;pathsep 文件路径分隔符&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;curdir 当前工作目录&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;pardir 父目录&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;os 模块是处理好了这件事，但其它模块却不一定。&lt;/p&gt;
&lt;/section&gt;
&lt;section id="python-2"&gt;
&lt;h2&gt;Python 2 的写文件&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;open()，可能最早从 c 语言 fopen 学习的，未考虑编码参数&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;codecs.open()，支持编码参数&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;io.open()，支持编码参数的 open()，推荐使用&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
&lt;section id="python-3"&gt;
&lt;h2&gt;Python 3 的写文件&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;open()，修正了 Python 2 时代的设计遗漏，支持 encoding 和 newline 参数&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;codecs.open()，在读写文件时不推荐使用了，且此模块方法在 Windows 下有坑，文件换行符会弄成 LF&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
&lt;section id="section-2"&gt;
&lt;h2&gt;不同平台的差异随处可见&lt;/h2&gt;
&lt;p&gt;一定程度上反映了，人各有各的思想，分久必合，当人们无法忍受差异时，就会发展为统一。&lt;/p&gt;
&lt;/section&gt;</description><category>linesep</category><category>newline</category><category>python</category><guid>https://note.tt4e.com/posts/the-different-linesep-between-codecs-open-and-open-in-python-3/</guid><pubDate>Wed, 13 Dec 2023 12:01:17 GMT</pubDate></item><item><title>Absolute and Relative Path in Python</title><link>https://note.tt4e.com/posts/absolute-and-relative-path-in-python/</link><dc:creator>逍遥</dc:creator><description>&lt;section id="os-path-isabs"&gt;
&lt;h2&gt;1. os.path.isabs()&lt;/h2&gt;
&lt;p&gt;os.path.isabs() 的行为是：如果路径以 / 开头，或者在非类 Unix 平台上，以盘符跟一个 os.sep 开头，就返回 True；否则，就返回 False&lt;/p&gt;
&lt;p&gt;这里要注意的是在 Windows 上，是支持两种斜线符号的，一种是Windows的斜线，但需要双写以转义 '\'，另一种是类似 Unix 反写 '/'。&lt;/p&gt;
&lt;p&gt;看如下代码，在 Windows 下的返回结果&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-1" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-1" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;Python&lt;/span&gt; &lt;span class="mf"&gt;3.10.6&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tags&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v3&lt;/span&gt;&lt;span class="mf"&gt;.10.6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="n"&gt;c7b4bd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Aug&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;2022&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;21&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;53&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;49&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;MSC&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="mf"&gt;.1932&lt;/span&gt; &lt;span class="mi"&gt;64&lt;/span&gt; &lt;span class="n"&gt;bit&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AMD64&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;win32&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-2" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-2" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;Type&lt;/span&gt; &lt;span class="s2"&gt;"help"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"copyright"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"credits"&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="s2"&gt;"license"&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;more&lt;/span&gt; &lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-3" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-3" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-3"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-4" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-4" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-4"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isabs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'c:/abc'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-5" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-5" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-5"&gt;&lt;/a&gt;&lt;span class="kc"&gt;True&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-6" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-6" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-6"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isabs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/abc'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-7" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-7" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-7"&gt;&lt;/a&gt;&lt;span class="kc"&gt;True&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-8" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-8" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-8"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isabs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'c:&lt;/span&gt;&lt;span class="se"&gt;\a&lt;/span&gt;&lt;span class="s1"&gt;bc'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# 未转义，错误&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-9" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-9" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-9"&gt;&lt;/a&gt;&lt;span class="kc"&gt;False&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-10" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-10" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-10"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isabs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'c:/abc'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-11" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-11" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-11"&gt;&lt;/a&gt;&lt;span class="kc"&gt;True&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-12" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-12" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-12"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isabs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'c:&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;abc'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-13" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-13" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-13"&gt;&lt;/a&gt;&lt;span class="kc"&gt;True&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-14" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-14" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-14"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isabs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;abc'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-15" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-15" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-15"&gt;&lt;/a&gt;&lt;span class="kc"&gt;True&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-16" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-16" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-16"&gt;&lt;/a&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isabs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'abc'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-17" name="rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-17" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_83701d6a0ee1460a9e5e5445e1ac4c62-17"&gt;&lt;/a&gt;&lt;span class="kc"&gt;False&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;所以说，实际上这个方法在 Windows 并不好用，试着查看源代码，但实现并不是 Python 的，似乎有 macpath,posixpath,ntpath，但 ntpath 在 Windows 上返回就是上述值。&lt;/p&gt;
&lt;/section&gt;
&lt;section id="pathlib-path-is-absolute-windows"&gt;
&lt;h2&gt;2. pathlib.Path().is_absolute() 在 Windows 上更好用&lt;/h2&gt;
&lt;p&gt;实际上判断是否绝对路径时，应该使用以下代码&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_7334ec3b73724a4da776905f79b5bfcc-1" name="rest_code_7334ec3b73724a4da776905f79b5bfcc-1" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_7334ec3b73724a4da776905f79b5bfcc-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pathlib&lt;/span&gt;
&lt;a id="rest_code_7334ec3b73724a4da776905f79b5bfcc-2" name="rest_code_7334ec3b73724a4da776905f79b5bfcc-2" href="https://note.tt4e.com/posts/absolute-and-relative-path-in-python/#rest_code_7334ec3b73724a4da776905f79b5bfcc-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;pathlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/abc'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_absolute&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;</description><category>path</category><category>python</category><guid>https://note.tt4e.com/posts/absolute-and-relative-path-in-python/</guid><pubDate>Thu, 07 Dec 2023 00:12:45 GMT</pubDate></item></channel></rss>