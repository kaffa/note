<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>琅環笔记 (关于 pycharm 的文章)</title><link>https://note.tt4e.com/</link><description></description><atom:link href="https://note.tt4e.com/categories/pycharm.xml" rel="self" type="application/rss+xml"></atom:link><language>zh_cn</language><copyright>Contents © 2024 &lt;a href="mailto:xiaoyao@tt4e.com"&gt;逍遥&lt;/a&gt; </copyright><lastBuildDate>Sat, 20 Jan 2024 15:52:36 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>SQLite Error database disk image is malformed by PyCharm</title><link>https://note.tt4e.com/posts/sqlite-error-database-disk-image-is-malformed-by-pycharm/</link><dc:creator>逍遥</dc:creator><description>&lt;section id="tips"&gt;
&lt;h2&gt;大多数 Tips 背后总能找到一个设计错误&lt;/h2&gt;
&lt;p&gt;Tips 之所以让人眼前一亮，那是因为这个 Tips 的结构不寻常。&lt;/p&gt;
&lt;p&gt;大体上，是因为设计者没有想到，或者想到了，但没有设计好导致的。&lt;/p&gt;
&lt;p&gt;比如下面这个：&lt;/p&gt;
&lt;/section&gt;
&lt;section id="database-disk-image-is-malformed"&gt;
&lt;h2&gt;database disk image is malformed&lt;/h2&gt;
&lt;p&gt;SQLite 提示 "database disk image is malformed"&lt;/p&gt;
&lt;p&gt;看起来很惊悚，说是数据库磁盘镜像畸形了。&lt;/p&gt;
&lt;p&gt;第一感觉似乎是磁盘硬件坏道了？&lt;/p&gt;
&lt;/section&gt;
&lt;section id="section-1"&gt;
&lt;h2&gt;问题重现&lt;/h2&gt;
&lt;p&gt;当我在 PyCharm 中选中了项目的根目录后，在菜单 File -&amp;gt; File Properties -&amp;gt; Line Separators 的切换后，SQLite 数据库文件报错了；&lt;/p&gt;
&lt;p&gt;我进行这个操作的主要原因是，每当我添加文件到 git 时，以 LF 为分隔符的 sitemap.xml 文件总是有一个 warning；&lt;/p&gt;
&lt;p&gt;而这个报错的主要原因，被证明是一个 Python 2 的遗留问题导致的。&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_379ce1ae869c478ca4824bb6508fa083-1" name="rest_code_379ce1ae869c478ca4824bb6508fa083-1" href="https://note.tt4e.com/posts/sqlite-error-database-disk-image-is-malformed-by-pycharm/#rest_code_379ce1ae869c478ca4824bb6508fa083-1"&gt;&lt;/a&gt;&amp;gt;git&lt;span class="w"&gt; &lt;/span&gt;add&lt;span class="w"&gt; &lt;/span&gt;.
&lt;a id="rest_code_379ce1ae869c478ca4824bb6508fa083-2" name="rest_code_379ce1ae869c478ca4824bb6508fa083-2" href="https://note.tt4e.com/posts/sqlite-error-database-disk-image-is-malformed-by-pycharm/#rest_code_379ce1ae869c478ca4824bb6508fa083-2"&gt;&lt;/a&gt;warning:&lt;span class="w"&gt; &lt;/span&gt;LF&lt;span class="w"&gt; &lt;/span&gt;will&lt;span class="w"&gt; &lt;/span&gt;be&lt;span class="w"&gt; &lt;/span&gt;replaced&lt;span class="w"&gt; &lt;/span&gt;by&lt;span class="w"&gt; &lt;/span&gt;CRLF&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;docs/sitemap.xml.
&lt;a id="rest_code_379ce1ae869c478ca4824bb6508fa083-3" name="rest_code_379ce1ae869c478ca4824bb6508fa083-3" href="https://note.tt4e.com/posts/sqlite-error-database-disk-image-is-malformed-by-pycharm/#rest_code_379ce1ae869c478ca4824bb6508fa083-3"&gt;&lt;/a&gt;The&lt;span class="w"&gt; &lt;/span&gt;file&lt;span class="w"&gt; &lt;/span&gt;will&lt;span class="w"&gt; &lt;/span&gt;have&lt;span class="w"&gt; &lt;/span&gt;its&lt;span class="w"&gt; &lt;/span&gt;original&lt;span class="w"&gt; &lt;/span&gt;line&lt;span class="w"&gt; &lt;/span&gt;endings&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;your&lt;span class="w"&gt; &lt;/span&gt;working&lt;span class="w"&gt; &lt;/span&gt;directory
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="section-2"&gt;
&lt;h2&gt;问题原因&lt;/h2&gt;
&lt;p&gt;没有充分证实，但非常有可能是 LF 到 CRLF 的替换损坏了 SQLite 的数据库文件。&lt;/p&gt;
&lt;p&gt;你想问问 PyCharm，你怎么这么蠢？&lt;/p&gt;
&lt;p&gt;PyCharm 可能会说，怪我干什么，我只是个工具！&lt;/p&gt;
&lt;p&gt;但我认为吧，PyCharm 确实有理由识别这是一个数据库文件吧，毕竟你是可以直接打开浏览和处理的。&lt;/p&gt;
&lt;p&gt;好在此处，是之用到 SQLite 作为数据生成的本地缓存，且在 GitHub 上有备份，于是拿了一份下来本地覆盖既修复了。&lt;/p&gt;
&lt;/section&gt;</description><category>pycharm</category><category>sqlite</category><guid>https://note.tt4e.com/posts/sqlite-error-database-disk-image-is-malformed-by-pycharm/</guid><pubDate>Wed, 13 Dec 2023 13:14:50 GMT</pubDate></item></channel></rss>