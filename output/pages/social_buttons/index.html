<!DOCTYPE html>
<html prefix="" lang="zh_cn">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Using Alternative Social Buttons with Nikola | 琅環笔记</title>
<meta name="theme-color" content="#FED43F">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://www.tt4e.com/pages/social_buttons/">
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/font-awesome.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/styles.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/custom.css" rel="stylesheet" type="text/css">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="The Nikola Team">
</head>
<body>
<script type="text/javascript">
  // Detect JS support
  document.body.className = document.body.className + " js_enabled";
</script><a href="#content" class="sr-only sr-only-focusable">跳到主内容</a>
<div id="container">
    <section class="hero is-primary"><!-- Hero header: will stick at the top --><div class="hero-head">
  <header id="header" class="nav"><div class="container">
      <div class="nav-left">
        
<div class="nav-item is-brand">
  <h1 id="brand" class="site-header">
      <a href="https://www.tt4e.com/" title="琅環笔记" rel="home">
        
  <span class="level is-mobile">


  <span id="blog-title" class="level-item site-title">琅環笔记</span>

  </span>

      </a>
  </h1>
</div>

        

      </div>
      
<!-- This "nav-toggle" hamburger menu is only visible on mobile -->
<!-- You need JavaScript to toggle the "is-active" class on "nav-menu" -->
<span id="nav-toggle-burger" class="nav-toggle">
  <span></span>
  <span></span>
  <span></span>
</span>
<div id="menu" class="nav-right nav-menu">
      <a class="nav-item" title="文章归档" href="../../archive.html">文章归档</a>
      <a class="nav-item" title="标签" href="../../categories/">标签</a>
      <a class="nav-item" title="RSS 源" href="../../rss.xml">RSS 源</a>


</div>
<script type="text/javascript">
document.getElementById('nav-toggle-burger').onclick = function() {
  var myMenu = document.getElementById('menu');
  var className = ' ' + myMenu.className + ' ';
  var IS_ACTIVE_CLASS = 'is-active';
  if ( ~className.indexOf(' ' + IS_ACTIVE_CLASS + ' ') ) {
    myMenu.className = className.replace(' ' + IS_ACTIVE_CLASS + ' ', ' ');
  } else {
    myMenu.className += ' ' + IS_ACTIVE_CLASS;
  }
}
</script>
</div>
  </header>
</div>

    <!-- Hero content: will be in the middle -->
    
  
    

    <!-- Hero footer: will stick at the bottom -->
  </section><main id="content" class="section section-main"><div class="container">
      
<article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header class="heading"><h1 class="title is-1 p-name entry-title" itemprop="headline name">
    <a href="." class="u-url">Using Alternative Social Buttons with Nikola</a>
  </h1>

    

  </header><div class="section content e-content entry-content" itemprop="articleBody text">
    <dl class="docinfo simple">
<dt class="version">Version<span class="colon">:</span>
</dt>
<dd class="version">
<p>8.2.4</p>
</dd>
</dl>
<nav class="contents alert alert-primary float-md-right" id="topic-1" role="doc-toc"><p class="topic-title">目录</p>
<ul class="simple">
<li><p><a class="reference internal" href="#the-default" id="toc-entry-1">The Default</a></p></li>
<li><p><a class="reference internal" href="#sharenice" id="toc-entry-2">ShareNice</a></p></li>
<li>
<p><a class="reference internal" href="#socialshareprivacy" id="toc-entry-3">SocialSharePrivacy</a></p>
<ul>
<li><p><a class="reference internal" href="#the-hard-way" id="toc-entry-4">The Hard Way</a></p></li>
<li><p><a class="reference internal" href="#the-easy-way" id="toc-entry-5">The Easy Way</a></p></li>
</ul>
</li>
</ul></nav><section id="the-default"><h2><a class="toc-backref" href="#toc-entry-1" role="doc-backlink">The Default</a></h2>
<p>By Default, the themes provided with Nikola will add to your pages a "slide in" widget at
the bottom right of the page, provided by Addthis. This is the HTML code for that:</p>
<div class="code"><pre class="code html"><a id="rest_code_f745df2f73714a62a0835eba22fe9c15-1" name="rest_code_f745df2f73714a62a0835eba22fe9c15-1" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-1"></a><span class="cm">&lt;!-- Social buttons --&gt;</span>
<a id="rest_code_f745df2f73714a62a0835eba22fe9c15-2" name="rest_code_f745df2f73714a62a0835eba22fe9c15-2" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-2"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"addthisbox"</span> <span class="na">class</span><span class="o">=</span><span class="s">"addthis_toolbox addthis_peekaboo_style</span>
<a id="rest_code_f745df2f73714a62a0835eba22fe9c15-3" name="rest_code_f745df2f73714a62a0835eba22fe9c15-3" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-3"></a><span class="s">    addthis_default_style addthis_label_style addthis_32x32_style"</span><span class="p">&gt;</span>
<a id="rest_code_f745df2f73714a62a0835eba22fe9c15-4" name="rest_code_f745df2f73714a62a0835eba22fe9c15-4" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-4"></a><span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">"addthis_button_more"</span><span class="p">&gt;</span>Share<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="rest_code_f745df2f73714a62a0835eba22fe9c15-5" name="rest_code_f745df2f73714a62a0835eba22fe9c15-5" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-5"></a><span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">"addthis_button_facebook"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="rest_code_f745df2f73714a62a0835eba22fe9c15-6" name="rest_code_f745df2f73714a62a0835eba22fe9c15-6" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-6"></a><span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">"addthis_button_google_plusone_share"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="rest_code_f745df2f73714a62a0835eba22fe9c15-7" name="rest_code_f745df2f73714a62a0835eba22fe9c15-7" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-7"></a><span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">"addthis_button_linkedin"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="rest_code_f745df2f73714a62a0835eba22fe9c15-8" name="rest_code_f745df2f73714a62a0835eba22fe9c15-8" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-8"></a><span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">"addthis_button_twitter"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="rest_code_f745df2f73714a62a0835eba22fe9c15-9" name="rest_code_f745df2f73714a62a0835eba22fe9c15-9" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-9"></a><span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<a id="rest_code_f745df2f73714a62a0835eba22fe9c15-10" name="rest_code_f745df2f73714a62a0835eba22fe9c15-10" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-10"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="rest_code_f745df2f73714a62a0835eba22fe9c15-11" name="rest_code_f745df2f73714a62a0835eba22fe9c15-11" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-11"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">"//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a id="rest_code_f745df2f73714a62a0835eba22fe9c15-12" name="rest_code_f745df2f73714a62a0835eba22fe9c15-12" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-12"></a><span class="cm">&lt;!-- End of social buttons --&gt;</span>
<a id="rest_code_f745df2f73714a62a0835eba22fe9c15-13" name="rest_code_f745df2f73714a62a0835eba22fe9c15-13" href="#rest_code_f745df2f73714a62a0835eba22fe9c15-13"></a>"""
</pre></div>
<p>You can change that using the <code class="docutils literal">SOCIAL_BUTTONS_CODE</code> option in your conf.py. In some cases, just
doing that will be enough but in others, it won't. This document tries to describe all the bits
involved in making this work correctly.</p>
<dl>
<dt>Part 1: <code class="docutils literal">SOCIAL_BUTTONS_CODE</code>
</dt>
<dd>
<p>Social sharing services like addthis and others will provide you a HTML snippet.
If it is self-contained, then just setting <code class="docutils literal">SOCIAL_BUTTONS_CODE</code> may be enough.
Try :-)</p>
</dd>
<dt>Part 2: The theme</dt>
<dd>
<p>The <code class="docutils literal">SOCIAL_BUTTONS_CODE</code> HTML fragment will be embedded <em>somewhere</em> by the theme. Whether that
is the correct place or not is not something the theme author can truly know, so it is possible that
you may have to tweak the <code class="docutils literal">base.html</code> template to make it look good.</p>
</dd>
<dt>Part 3: <code class="docutils literal">BODY_END</code> and <code class="docutils literal">EXTRA_HEAD_DATA</code>
</dt>
<dd>
<p>Some social sharing code requires JS execution that depends on JQuery being available
(example: <a class="reference external" href="https://github.com/panzi/SocialSharePrivacy">SocialSharePrivacy</a>). It's good
practice (and often, the only way that will work) to put those at the end of <code class="docutils literal">&lt;BODY&gt;</code>,
and one easy way to do that is to put them in <code class="docutils literal">BODY_END</code></p>
<p>On the other hand, it's possible that it requires you to load some CSS files.
The right place for that is in the document's <code class="docutils literal">&lt;HEAD&gt;</code> so they should be added
in <code class="docutils literal">EXTRA_HEAD_DATA</code></p>
</dd>
<dt>Part 4: assets</dt>
<dd>
<p>For sharing code that doesn't rely on a social sharing service, you may need to add CSS, Image, or JS
files to your site</p>
</dd>
</dl></section><section id="sharenice"><h2><a class="toc-backref" href="#toc-entry-2" role="doc-backlink">ShareNice</a></h2>
<p><a class="reference external" href="https://graingert.co.uk/shareNice/">ShareNice</a> is "written in order to provide social sharing features to
web developers and website administrators who wish to maintain and protect their users' privacy"
which sounds cool to me.</p>
<p>Let's go step by step into integrating the hosted version of ShareNice into a Nikola site.</p>
<p>For testing purposes, let's do it on a demo site:</p>
<pre class="literal-block">$ nikola init --demo sharenice_test
A new site with example data has been created at sharenice_test.
See README.txt in that folder for more information.
$ cd sharenice_test/</pre>
<p>To see what's going on, let's start Nikola in "auto mode". This should build the
site and open a web browser showing the default configuration, with the AddThis widget:</p>
<pre class="literal-block">$ nikola auto -b</pre>
<p>First, let's add the HTML snippet that will show the sharing options. In your conf.py, set this, which
is the HTML code suggested by ShareNice:</p>
<div class="code"><pre class="code python"><a id="rest_code_778a86419c334a04b5f87e0461c994e7-1" name="rest_code_778a86419c334a04b5f87e0461c994e7-1" href="#rest_code_778a86419c334a04b5f87e0461c994e7-1"></a><span class="n">SOCIAL_BUTTONS_CODE</span> <span class="o">=</span> <span class="s2">"""&lt;div id="shareNice" data-share-label="Share"</span>
<a id="rest_code_778a86419c334a04b5f87e0461c994e7-2" name="rest_code_778a86419c334a04b5f87e0461c994e7-2" href="#rest_code_778a86419c334a04b5f87e0461c994e7-2"></a><span class="s2">    data-color-scheme="black" data-icon-size="32" data-panel-bottom="plain"</span>
<a id="rest_code_778a86419c334a04b5f87e0461c994e7-3" name="rest_code_778a86419c334a04b5f87e0461c994e7-3" href="#rest_code_778a86419c334a04b5f87e0461c994e7-3"></a><span class="s2">    data-services="plus.google.com,facebook.com,digg.com,email,delicious.com,twitter.com"</span>
<a id="rest_code_778a86419c334a04b5f87e0461c994e7-4" name="rest_code_778a86419c334a04b5f87e0461c994e7-4" href="#rest_code_778a86419c334a04b5f87e0461c994e7-4"></a><span class="s2">    style="float:right"&gt;&lt;/div&gt;"""</span>
<a id="rest_code_778a86419c334a04b5f87e0461c994e7-5" name="rest_code_778a86419c334a04b5f87e0461c994e7-5" href="#rest_code_778a86419c334a04b5f87e0461c994e7-5"></a>
<a id="rest_code_778a86419c334a04b5f87e0461c994e7-6" name="rest_code_778a86419c334a04b5f87e0461c994e7-6" href="#rest_code_778a86419c334a04b5f87e0461c994e7-6"></a><span class="n">BODY_END</span> <span class="o">=</span> <span class="s2">"""&lt;script src="https://graingert.co.uk/shareNice/code.js"&gt;&lt;/script&gt;"""</span>
</pre></div>
<p>And you should now see a sharing box at the bottom right of the page.</p>
<p>Main problem remaining is that it doesn't really look good and integrated in the page layout.
I suggest changing the code to this which looks nicer, but still has some placement issues:</p>
<div class="code"><pre class="code python"><a id="rest_code_6180ff88dc5249a6b56832db692e6640-1" name="rest_code_6180ff88dc5249a6b56832db692e6640-1" href="#rest_code_6180ff88dc5249a6b56832db692e6640-1"></a><span class="n">SOCIAL_BUTTONS_CODE</span> <span class="o">=</span> <span class="s2">"""&lt;div id="shareNice" data-share-label="Share"</span>
<a id="rest_code_6180ff88dc5249a6b56832db692e6640-2" name="rest_code_6180ff88dc5249a6b56832db692e6640-2" href="#rest_code_6180ff88dc5249a6b56832db692e6640-2"></a><span class="s2">    data-color-scheme="black" data-icon-size="32" data-panel-bottom="plain"</span>
<a id="rest_code_6180ff88dc5249a6b56832db692e6640-3" name="rest_code_6180ff88dc5249a6b56832db692e6640-3" href="#rest_code_6180ff88dc5249a6b56832db692e6640-3"></a><span class="s2">    data-services="plus.google.com,facebook.com,email,twitter.com"</span>
<a id="rest_code_6180ff88dc5249a6b56832db692e6640-4" name="rest_code_6180ff88dc5249a6b56832db692e6640-4" href="#rest_code_6180ff88dc5249a6b56832db692e6640-4"></a><span class="s2">    style="position: absolute; left: 20px; top: 60px;"&gt;&lt;/div&gt;"""</span>
</pre></div>
<p>If anyone comes up with a better idea of styling/placement, just let me know ;-)</p>
<p>One bad bit of this so far is that you are now using a script from another site, and that
doesn't let Nikola perform as many optimizations to your page as it could.
So, if you really want to go the extra mile to save a few KB and round trips, you <em>could</em>
install your own copy from the <a class="reference external" href="https://github.com/mischat/shareNice">github repo</a> and
use that instead of the copy at <a class="reference external" href="https://graingert.co.uk/shareNice">ShareNice</a>.</p>
<p>Then, you can create your own theme inheriting from the one you are using and add the CSS
and JS files from ShareNice into your <code class="docutils literal">bundles</code> configuration so they are combined and
minified.</p>
</section><section id="socialshareprivacy"><h2><a class="toc-backref" href="#toc-entry-3" role="doc-backlink">SocialSharePrivacy</a></h2>
<section id="the-hard-way"><h3><a class="toc-backref" href="#toc-entry-4" role="doc-backlink">The Hard Way</a></h3>
<p><a class="reference external" href="https://github.com/panzi/SocialSharePrivacy">SocialSharePrivacy</a> is "a jQuery plugin that
lets you add social share buttons to your website that don't allow the social sites to track
your users." Nice!</p>
<p>Let's go step-by-step into integrating SocialSharePrivacy into a Nikola site. To improve
privacy, they recommend you not use the hosted service so we'll do it the hard way, by
getting and distributing everything in our own site.</p>
<p><a class="reference external" href="https://github.com/panzi/SocialSharePrivacy">https://github.com/panzi/SocialSharePrivacy</a></p>
<p>For testing purposes, let's do it on a demo site:</p>
<pre class="literal-block">$ nikola init --demo ssp_test
A new site with example data has been created at ssp_test.
See README.txt in that folder for more information.
$ cd ssp_test/</pre>
<p>To see what's going on, let's start Nikola in "auto mode". This should build the
site and open a web browser showing the default configuration, with the AddThis widget:</p>
<pre class="literal-block">$ nikola auto -b</pre>
<p>Now, download <a class="reference external" href="https://github.com/panzi/SocialSharePrivacy/archive/master.zip">the current version</a>
and unzip it. You will have a <code class="docutils literal"><span class="pre">SocialSharePrivacy-master</span></code> folder with lots of stuff in it.</p>
<p>First, we need to build it (this requires a working and modern uglifyjs, this may not be easy):</p>
<pre class="literal-block">$ cd SocialSharePrivacy-master
$ sh build.sh -m gplus,twitter,facebook,mail -s "/assets/css/socialshareprivacy.css" -a off</pre>
<p>You will now have several files in a <code class="docutils literal">build</code> folder. We need to bring them into the site:</p>
<pre class="literal-block">$ cp -Rv SocialSharePrivacy-master/build/* files/
$ cp -R SocialSharePrivacy-master/images/ files/assets/</pre>
<p>Edit your <code class="docutils literal">conf.py</code>:</p>
<div class="code"><pre class="code python"><a id="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-1" name="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-1" href="#rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-1"></a><span class="n">BODY_END</span> <span class="o">=</span> <span class="s2">"""</span>
<a id="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-2" name="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-2" href="#rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-2"></a><span class="s2">&lt;script src="/javascripts/jquery.socialshareprivacy.min.js"&gt;&lt;/script&gt;</span>
<a id="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-3" name="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-3" href="#rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-3"></a><span class="s2">&lt;script&gt;</span>
<a id="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-4" name="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-4" href="#rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-4"></a><span class="s2">$(document).ready(function () {</span>
<a id="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-5" name="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-5" href="#rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-5"></a><span class="s2">    $('.share').socialSharePrivacy();</span>
<a id="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-6" name="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-6" href="#rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-6"></a><span class="s2">});</span>
<a id="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-7" name="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-7" href="#rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-7"></a><span class="s2">&lt;/script&gt;</span>
<a id="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-8" name="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-8" href="#rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-8"></a><span class="s2">"""</span>
<a id="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-9" name="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-9" href="#rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-9"></a>
<a id="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-10" name="rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-10" href="#rest_code_4af8c871319b4f9fb7d1b0c597e3bcc7-10"></a><span class="n">SOCIAL_BUTTONS_CODE</span> <span class="o">=</span> <span class="s2">"""&lt;div class="share"&gt;&lt;/div&gt;"""</span>
</pre></div>
<p>In my experience this produces a broken, duplicate, semi-working thing. YMMV and if you make it work correctly, let me know how :-)</p>
</section><section id="the-easy-way"><h3><a class="toc-backref" href="#toc-entry-5" role="doc-backlink">The Easy Way</a></h3>
<p>Go to <a class="reference external" href="https://panzi.github.io/SocialSharePrivacy/">https://panzi.github.io/SocialSharePrivacy/</a> and use the provided form to get the code. Make sure you check "I already use JQuery"
if you are using one of the themes that require it, like site or default, select the services you want, and use your disqus name if
you have one.</p>
<p>It will give you 3 code snippets:</p>
<dl class="simple">
<dt>"Insert this once in the head of your page"</dt>
<dd>
<p>Put it in <code class="docutils literal">BODY_END</code></p>
</dd>
<dt>"Insert this wherever you want a share widget displayed"</dt>
<dd>
<p>Put it in <code class="docutils literal">SOCIAL_BUTTONS_CODE</code></p>
</dd>
<dt>"Insert this once anywhere after the other code"</dt>
<dd>
<p>Put it in <code class="docutils literal">BODY_END</code></p>
</dd>
</dl>
<p>That should give you a working integration (not tested)</p>
</section></section>
</div>
  

</article>
</div>
  </main><footer id="footer" class="footer"><div class="container">
      Contents © 2023         <a href="mailto:xiaoyao@tt4e.com">逍遥</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
      
    </div>
  </footer>
</div>

  




</body>
</html>
