<section id="nikola-tips">
<h1>Nikola Tips</h1>
<section id="nikola-serve">
<h2>1. Nikola serve 自动刷新的命令行怎么写？</h2>
<div class="code"><pre class="code shell"><a id="rest_code_9441212948ef4caf99ea58766b55503d-1" name="rest_code_9441212948ef4caf99ea58766b55503d-1" href="#rest_code_9441212948ef4caf99ea58766b55503d-1"></a>nikola<span class="w"> </span>auto
</pre></div>
<p>即使 <strong>conf.py</strong> 中已绑定非127.0.0.1的地址，上面的命令也只会在127.0.0.1启动调试。</p>
<p>没有去看源代码，可能这样实现从安全角度存在一定的合理性。</p>
<p>如果需要任意主机都能获得访问，可使用 -a 参数指定地址0.0.0.0</p>
<div class="code"><pre class="code shell"><a id="rest_code_8bbab2be079840728fe76bea19ef23da-1" name="rest_code_8bbab2be079840728fe76bea19ef23da-1" href="#rest_code_8bbab2be079840728fe76bea19ef23da-1"></a>nikola<span class="w"> </span>auto<span class="w"> </span>-a0.0.0.0
</pre></div>
</section>
<section id="nikola-theme-css">
<h2>2. Nikola Theme 如何定制 css</h2>
<p>如果在模板中有代码</p>
<div class="code"><pre class="code html+mako"><a id="rest_code_a4749c7788744a3d97e5310e753c07aa-1" name="rest_code_a4749c7788744a3d97e5310e753c07aa-1" href="#rest_code_a4749c7788744a3d97e5310e753c07aa-1"></a><span class="cp">%</span><span class="k">if</span> <span class="n">has_custom_css</span><span class="p">:</span>
<a id="rest_code_a4749c7788744a3d97e5310e753c07aa-2" name="rest_code_a4749c7788744a3d97e5310e753c07aa-2" href="#rest_code_a4749c7788744a3d97e5310e753c07aa-2"></a>  <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/assets/css/custom.css&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
<a id="rest_code_a4749c7788744a3d97e5310e753c07aa-3" name="rest_code_a4749c7788744a3d97e5310e753c07aa-3" href="#rest_code_a4749c7788744a3d97e5310e753c07aa-3"></a><span class="cp">%</span><span class="k">endif</span>
</pre></div>
<p>因此，增加 /assets/css/custom.css 文件即可。</p>
</section>
<section id="nikola-github">
<h2>3. Nikola 如何推送到 GitHub</h2>
<p>先设置好 git 推送</p>
<div class="code"><pre class="code sh"><a id="rest_code_07536cbd58b34935adcdb82462349da8-1" name="rest_code_07536cbd58b34935adcdb82462349da8-1" href="#rest_code_07536cbd58b34935adcdb82462349da8-1"></a>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>--add<span class="w"> </span>safe.directory<span class="w"> </span>/usr/home/kaffa/web/note.tt4e.com
<a id="rest_code_07536cbd58b34935adcdb82462349da8-2" name="rest_code_07536cbd58b34935adcdb82462349da8-2" href="#rest_code_07536cbd58b34935adcdb82462349da8-2"></a>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.email<span class="w"> </span><span class="s2">&quot;kaffacoffee@outlook.com&quot;</span>
<a id="rest_code_07536cbd58b34935adcdb82462349da8-3" name="rest_code_07536cbd58b34935adcdb82462349da8-3" href="#rest_code_07536cbd58b34935adcdb82462349da8-3"></a>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.name<span class="w"> </span><span class="s2">&quot;Kaffa&quot;</span>
</pre></div>
<p>将以下内容保存为 aio.sh 脚本</p>
<div class="code"><pre class="code sh"><a id="rest_code_c19b5a1fb8ad4b7baefd172118def513-1" name="rest_code_c19b5a1fb8ad4b7baefd172118def513-1" href="#rest_code_c19b5a1fb8ad4b7baefd172118def513-1"></a><span class="ch">#!/bin/bash</span>
<a id="rest_code_c19b5a1fb8ad4b7baefd172118def513-2" name="rest_code_c19b5a1fb8ad4b7baefd172118def513-2" href="#rest_code_c19b5a1fb8ad4b7baefd172118def513-2"></a><span class="c1">#</span>
<a id="rest_code_c19b5a1fb8ad4b7baefd172118def513-3" name="rest_code_c19b5a1fb8ad4b7baefd172118def513-3" href="#rest_code_c19b5a1fb8ad4b7baefd172118def513-3"></a><span class="c1"># nikola output push to github</span>
<a id="rest_code_c19b5a1fb8ad4b7baefd172118def513-4" name="rest_code_c19b5a1fb8ad4b7baefd172118def513-4" href="#rest_code_c19b5a1fb8ad4b7baefd172118def513-4"></a><span class="nb">cd</span><span class="w"> </span>~/web/note.tt4e.com/
<a id="rest_code_c19b5a1fb8ad4b7baefd172118def513-5" name="rest_code_c19b5a1fb8ad4b7baefd172118def513-5" href="#rest_code_c19b5a1fb8ad4b7baefd172118def513-5"></a>nikola<span class="w"> </span>build
<a id="rest_code_c19b5a1fb8ad4b7baefd172118def513-6" name="rest_code_c19b5a1fb8ad4b7baefd172118def513-6" href="#rest_code_c19b5a1fb8ad4b7baefd172118def513-6"></a>git<span class="w"> </span>add<span class="w"> </span>.
<a id="rest_code_c19b5a1fb8ad4b7baefd172118def513-7" name="rest_code_c19b5a1fb8ad4b7baefd172118def513-7" href="#rest_code_c19b5a1fb8ad4b7baefd172118def513-7"></a>git<span class="w"> </span>commit<span class="w"> </span>-am<span class="w"> </span><span class="s1">&#39;Kaffa&#39;</span>
<a id="rest_code_c19b5a1fb8ad4b7baefd172118def513-8" name="rest_code_c19b5a1fb8ad4b7baefd172118def513-8" href="#rest_code_c19b5a1fb8ad4b7baefd172118def513-8"></a>git<span class="w"> </span>push
</pre></div>
<p>先 su 到 root 用户，然后运行以下命令，再 su 会当前用户</p>
<div class="code"><pre class="code sh"><a id="rest_code_7a6d8d235c9241aea4479bd9c9b31851-1" name="rest_code_7a6d8d235c9241aea4479bd9c9b31851-1" href="#rest_code_7a6d8d235c9241aea4479bd9c9b31851-1"></a>chown<span class="w"> </span>-R<span class="w"> </span>kaffa:wheel<span class="w"> </span>.git
<a id="rest_code_7a6d8d235c9241aea4479bd9c9b31851-2" name="rest_code_7a6d8d235c9241aea4479bd9c9b31851-2" href="#rest_code_7a6d8d235c9241aea4479bd9c9b31851-2"></a>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">777</span><span class="w"> </span>./aio.sh
</pre></div>
<p>如果遇到错误提示 Unable to create ... /.git/index.lock: Permission denied，则需要</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">&lt;string&gt;</span>, line 71)</p>
<p>Error in &quot;code-block&quot; directive:
maximum 1 argument(s) allowed, 5 supplied.</p>
<pre class="literal-block">.. code-block :: sh
  chown -R kaffa:wheel .git
</pre>
</aside>
<p>其中 用户名和所属组，可以用 groups 命令查看。</p>
<p>完成书上步骤后，则每次可以运行 aio.sh 来推送 GitHub，GitHub 收到推送后，会使用 GitHub Action 来处理发布。</p>
<p>使用以上方法是有效的，但却说明没有认真读 nikola 文档。</p>
</section>
</section>
